\chapter*{Introduction}
\addcontentsline{toc}{chapter}{Introduction}


  \section*{General context}

    \paragraph{}
    This work is rooted in the field of numerical simulation of fluid dynamics, applied to \PS{energy/energetics}.
    This field gathers many industrial actors (the French Directorate General of Armaments, ArianeGroup, Safran, Airbus, etc) as well as academics (ONERA, CERFACS, DLR, VKI, universities, etc).
    It is interested in how to simulate a fluid flow with a computer, trying to represent the physical reality faithfully.
    The various actors in this field need to be able to access certain physical quantities associated with specific phenomena and operating regimes.
    These regimes are often not feasible on our scale, due to material or financial limitations.
    Examples include the study of icing on the wing of an aircraft, which is experimentally feasible but represents an imposing budget for the aircraft manufacturer, or the study of heat transfer in an atmospheric reentry capsule, which is much more difficult to achieve experimentally.
    To overcome these limitations, numerical simulation is the best option, as it allows such a case study to be modelled by the execution of a computer program, and to obtain a large set of data that will be analysed afterwards to answer the desired questions.

    \paragraph{}
    The analysis of physics usually produces a set of equations, often partial differential equations, representing the real system that one wishes to study.
    Algorithms are then required to determine the fluid flow from these equations, in the working domain, as a function of time.
    Thus, to obtain the desired quantities, the physical system is integrated in time using mathematical algorithms to obtain its evolution in time.
    Often, the expected result is not the complete temporal evolution of the system, but only its equilibrium state.
    This is called a steady numerical simulation or steady computation.
    Steady computations are opposed to unsteady computations that aim to accurately describe the system temporal evolution.

    \paragraph{}
    For all computational fluid dynamics users, the most crucial issue is to achieve a satisfying compromise between computational cost and accuracy of the results.
    Indeed, a quick and inexpensive computation tends to be not very faithful to physics, while an accurate computation tends to use more computational ressources and time.
    For steady computations, speed corresponds to getting the final steady state at a low time cost, for both computational time and the time it actually took to a user.
    It results in a compromise between methods that are expensive in terms of computational ressources and take a long time but give accurate results that are close to the physical reality, and faster methods that saves ressources but give lesser quality results.
    A software developer working on a numerical simulation tool needs to choose methods and algorithms to obtain a compromise that he considers satisfactory.
    The final interest for a player in computational fluid dynamics is therefore to have a result that is sufficiently precise and inexpensive enough to obtain.
    An accurate result is needed to answer the questions that required the simulation.
    The search for a result that is inexpensive to obtain is motivated by questions of savings in computational cost.
    This cost is applied to the user, while he wait for the simulation to end, and to its company through the cost in computer ressources, electricity, investments in more efficient machines, etc.

    \paragraph{}
    Depending on the problem to be solved, there are more or less suitable algorithms and methods.
    Performant methods were originally developed to answer needs from the aerodynamics community.
    In the case of energetic and multi-physics problems, the methods issued from the more traditional aerodynamics are limited by the coupling  between the different physics which have their distinct characteristic times.
    Thus, the algorithms used for the numerical simulation of classical fluid dynamics, i.e. concentrated on the resolution of the Navier--Stokes equations, are not necessarily the most adapted to a simulation in the energetic domain.
    The involvement of several distinct physical phenomena imposes constraints on the choice and use of algorithms.
    Consequently, it would be advisable to adapt or replace the algorithms involved in the time integration for multiphysics problems.


  \section*{Context of this thesis}

    \paragraph{}
    This thesis was conducted at ONERA, the French Aerospace Lab, in the multiphysics for energetics department.
    Although numerical simulation has been greatly developed in the aeronautical field, it has not been so well adapted to the multiphysics field, and many industrial codes are content to reuse the same algorithms.
    This is the example of the software system CEDRE, developed at ONERA by the multiphysics for energetics department \cite{ReflochCourbetMurroneEtAl2011}.
    This software system constitutes a platform grouping several solvers to integrate several physics: each solver is dedicated to its physical model.
    There is a solver for the resolution of compressible, multifluid, reactive and turbulent flows, two solvers for the calculation of dispersed phase (drops, crystals, particles) in Eulerian and Lagrangian approach respectively, a solver dedicated to the calculation of liquid films, a solver dedicated to radiation, etc.
    Thus, CEDRE is in fact a global solver adapted to multiphysics problems.
    Older work has been done to set up a time integration adapted to the problems solved by CEDRE \cite{Selva1998}.
    Work on time integration has led to the development of implicit integration methods for the integration of steady problems, and to the development of a GMRES method for the solution of linear systems.
    Users can choose from a panel of integration methods to obtain methods adapted to their problems.
    However, the weak coupling between solvers hampers the convergence to the steady state and the choice in integration methods is limited, compared to what can be found in the literature.
    This is at least the opinion of the actors of the CEDRE code, i.e. its developers and users, who would like more robust methods to be able to use CEDRE on steeper problems, and converging faster to save on computational cost.

    \paragraph{}
    On the research side, however, many efforts have been made in the direction of multiphysics, but have not yet left the academic framework.
    This is for example the case of \cite{WongKwokHorneEtAl2019}, who were interested in the temporal integration of coupled equations.
    They designed an integration method adapted to coupled equations, which is an evolution of a fixed point method with the addition of a step of a Newton method.
    They then compared this method to the standard fixed point method, which is more commonly used for coupled solution.
    By implementing their method on two simple coupling problems, they finally showed the interest of their method compared to the more standard method.
    If this method is well fitted for their calculations, it is however only implemented for simple problems, less complex than the multiphysics problems that CEDRE wishes to solve.
    Moreover, the tests carried out are on problems on an academic scale, and not on an industrial scale.

    \paragraph{}
    At the same time, tools used in aerodynamic simulation could prove interesting for multiphysics problems.
    The Jacobian-Free Newton--Krylov method, or JFNK, is already well used in the numerical simulation of the Navier--Stokes equations.
    In \cite{ParkNourgalievMartineauEtAl2009}, a time integration mechanism is implemented around a JFNK formulation.
    A physics-based preconditioning is developed to solve the linear problem more precisely.
    This time integration is then tested on a thermally driven cavity problem.
    However, this work is only concerned with the Navier--Stokes equations and is not extended to more general energetics problems.
    Finally, it is only tested on a two-dimensional academic problem.
    In \cite{ContentOuttierCinnella2013}, is was also used on academic problems for the turbulent Navier--Stokes equations.
    The Jacobian-Free Newton--Krylov method seems to be well fitted to problems that couple multiple physics.
    It was used in \cite{Turpault2003} on applications coupling radiative transfer with hydrodynamics.
    It could prove interesting as a time integration method for CEDRE multiphysic problems.


  \section*{General overview and motivations}

    \paragraph{}
    It can therefore be seen that numerical methods are already available to solve computational fluid dynamics problems.
    In particular, there are already solvers capable of solving steady multiphysics problems of industrial scales.
    However, such solver use methods inherited from the aerodynamic context, that are not always adapted to handle the difficulties arising from the multiphysic properties of our problems.
    It is at least the case for out solver CEDRE.
    On the other hand, other methods developed in an academic context have shown their interest on simple multiphysics problems.
    It would now seem interesting to adapt these new methods for the resolution of multiphysics problems in an industrial code.
    This is the reason for this study.
    It consists in improving the convergence, speed and robustness of the time integration of the CEDRE platform on steady multiphysics problems by adding numerical methods not used in industrial numerical simulation.
    The aim of this work is to improve the current performances of our solver by using such more recent methods.


  \section*{Outline}

    \paragraph{}
    L'objectif du chapitre 1 a été de développer une formulation JFNK pour AMÉLIORER QUOI DE l'intégration temporelle dans le code CEDRE.
    JUSTIFICATION
    Pour cela, l'idée a été d'adapter la méthode d'intégration en s'inspirant de la bibliographie en fonction de certains critères.
    L'idée suivante a été de développer une méthode de Newton afin de résoudre le problème non linéaire sachant que celui ci est produit par les méthodes d'intégration implicites utilisées lors de la résolution des problèmes stationnaires.
    L'idée suivante a été de développer une formulation sans matrice du système afin de mieux former les systèmes linéaires et permettre un couplage fort des solveurs de CEDRE.
    L'idée suivante a été d'adapter la résolution du système linéaire en utilisant des méthodes plus modernes que la méthode actuelle, en s'inspirant de la bibliographie, afin de résoudre plus précisément le système linéaire.
    On a alors obtenu une méthodologie d'intégration temporelle utilisable pour résoudre des problèmes multi-physique stationaires.
    A ce stade, cette méthode fonctionne au sens où elle permet d'obtenir un résultat à un problème de simulation numérique, mais elle n'est pas encore caractérisée.

    \paragraph{}
    L'idée du chapitre 2 a été d'évaluer la robustesse et la convergence de la formulation JFNK sur des problèmes stationnaire en multi-physiques au sein du code CEDRE.
    Pour cela, l'idée a été de sélectionner des cas tests de complexité croissante afin de représenter un ensemble de problèmes multi-physiques.
    L'idée suivante a été de mettre en place une méthode d'évaluation des performances de l'intégration temporelle afin de caractériser sa robustesse et sa vitesse de convergence.
    L'idée suivante a été de montrer que sur ces cas la formulation améliore la robustesse et la convergence afin de valider la pertinance du choix de la méthode.
    On estime qu'on a alors développé une méthode d'intégration temporelle "efficace", c'est à dire rendant l'intégration temporelle de CEDRE plus robuste et convergeant plus rapidement sur un ensemble de problèmes multi-physiques.
    On pourrait aller plus loin mais on va plutôt regarder l'intérêt de la formulation JFNK sur des problèmes autres pouvant en tirer profit : les problèmes instationnaires à grand pas de temps.

    \paragraph{}
    L'idée du chapitre 3 est d'analyser la formulation JFNK sur les problèmes instationnaires à grand pas de temps.
    Pour cela, l'idée a été d'identifier une classe de problèmes sortant du cadre initial de la thèse mais pouvant bénéficier de la formulation JFNK, afin d'y démontrer l'intérêt de la formulation.
    L'idée suivante a été de concevoir un cas d'étude afin de de mettre en valeur l'intérêt de la formulation JFNK.
    L'idée suivante a été de montrer l’intérêt la formulation sur ce cas.
